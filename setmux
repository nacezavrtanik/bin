#!/bin/bash

setup_sessions() {
if $(tmux ls > /dev/null 2>&1); then
    echo ERROR: tmux server already running!
    return 1
fi

here=$(pwd)

s0=null
cd
tmux new-session -d -s "$s0"
echo 0: "$s0"
s1=todo
cd
tmux new-session -d -s "$s1" -n todo 'todo --open'
echo 1: "$s1"

s2=bin
cd ~/bin
todo --list | grep -xq '\* bin' || todo --new bin
tmux new-session -d -s "$s2"
tmux new-window -t "$s2":2
tmux new-window -t "$s2":3 -n todo 'todo --open bin'
echo 2: "$s2"

if [ -f ~/bin/.sessions ]; then
    . ~/bin/.sessions
fi

cd "$here"
tmux attach-session -t "$s1" \; detach
}


setup_sessions

